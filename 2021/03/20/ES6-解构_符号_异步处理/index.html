<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/135xyq.github.io/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/135xyq.github.io/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/135xyq.github.io/images/favicon.ico">
  <link rel="mask-icon" href="/135xyq.github.io/images/logo.svg" color="#222">

<link rel="stylesheet" href="/135xyq.github.io/css/main.css">



<link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://unpkg.com/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"135xyq.github.io","root":"/135xyq.github.io/","images":"/135xyq.github.io/images","scheme":"Pisces","darkmode":false,"version":"8.8.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/135xyq.github.io/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="/135xyq.github.io/js/config.js"></script>
<meta name="description" content="数组和对象解构的介绍、符号这一新增数据类型的介绍和使用场景，js中异步处理的原理的使用">
<meta property="og:type" content="article">
<meta property="og:title" content="ES6中的解构 符号 异步处理">
<meta property="og:url" content="https://135xyq.github.io/135xyq.github.io/2021/03/20/ES6-%E8%A7%A3%E6%9E%84_%E7%AC%A6%E5%8F%B7_%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86/index.html">
<meta property="og:site_name" content="Ethan">
<meta property="og:description" content="数组和对象解构的介绍、符号这一新增数据类型的介绍和使用场景，js中异步处理的原理的使用">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://135xyq.github.io/images/ES6/%E8%A7%A3%E6%9E%84_%E7%AC%A6%E5%8F%B7_%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86-%E4%B8%A4%E4%B8%AA%E9%98%B6%E6%AE%B5.jpg">
<meta property="og:image" content="https://135xyq.github.io/images/ES6/%E8%A7%A3%E6%9E%84_%E7%AC%A6%E5%8F%B7_%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86-%E4%B8%A4%E4%B8%AA%E9%98%B6%E6%AE%B5%E7%9A%84%E8%BD%AC%E6%8D%A2.jpg">
<meta property="og:image" content="https://135xyq.github.io/images/ES6/%E8%A7%A3%E6%9E%84_%E7%AC%A6%E5%8F%B7_%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86-%E5%90%8E%E7%BB%AD%E5%A4%84%E7%90%86%E7%8A%B6%E6%80%81.jpg">
<meta property="og:image" content="https://135xyq.github.io/images/ES6/%E8%A7%A3%E6%9E%84_%E7%AC%A6%E5%8F%B7_%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86-Promise.jpg">
<meta property="article:published_time" content="2021-03-20T08:21:22.000Z">
<meta property="article:modified_time" content="2022-08-16T07:15:44.677Z">
<meta property="article:author" content="Ethan">
<meta property="article:tag" content="前端">
<meta property="article:tag" content="ES6">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://135xyq.github.io/images/ES6/%E8%A7%A3%E6%9E%84_%E7%AC%A6%E5%8F%B7_%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86-%E4%B8%A4%E4%B8%AA%E9%98%B6%E6%AE%B5.jpg">


<link rel="canonical" href="https://135xyq.github.io/135xyq.github.io/2021/03/20/ES6-%E8%A7%A3%E6%9E%84_%E7%AC%A6%E5%8F%B7_%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://135xyq.github.io/135xyq.github.io/2021/03/20/ES6-%E8%A7%A3%E6%9E%84_%E7%AC%A6%E5%8F%B7_%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86/","path":"2021/03/20/ES6-解构_符号_异步处理/","title":"ES6中的解构 符号 异步处理"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ES6中的解构 符号 异步处理 | Ethan</title>
  

  <script src="/135xyq.github.io/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?4301d11b48139d9c6adb4611ed1fc576"></script>



  <noscript>
    <link rel="stylesheet" href="/135xyq.github.io/css/noscript.css">
  </noscript>
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/135xyq.github.io/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Ethan</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">生如芥子，心藏须弥</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/135xyq.github.io/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/135xyq.github.io/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-project"><a href="/135xyq.github.io/project/" rel="section"><i class="fa fa-code fa-fw"></i>项目</a></li>
        <li class="menu-item menu-item-categories"><a href="/135xyq.github.io/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">61</span></a></li>
        <li class="menu-item menu-item-tags"><a href="/135xyq.github.io/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">52</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/135xyq.github.io/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">134</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A7%A3%E6%9E%84-%E7%AC%A6%E5%8F%B7-%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86"><span class="nav-text">解构 符号 异步处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E6%9E%84"><span class="nav-text">解构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E8%B1%A1%E8%A7%A3%E6%9E%84"><span class="nav-text">对象解构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E6%9E%84%E5%89%A9%E4%BD%99%E5%8F%82%E6%95%B0%EF%BC%9A"><span class="nav-text">解构剩余参数：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%8C%E5%90%8D%E8%A7%A3%E6%9E%84%EF%BC%88%E5%8F%98%E9%87%8F%E5%90%8D%E8%A6%81%E5%92%8C%E5%B1%9E%E6%80%A7%E5%90%8D%E4%B8%80%E8%87%B4%EF%BC%89"><span class="nav-text">同名解构（变量名要和属性名一致）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95%EF%BC%9A"><span class="nav-text">语法：</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%82%E5%90%8D%E8%A7%A3%E6%9E%84"><span class="nav-text">异名解构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B5%8C%E5%A5%97%E8%A7%A3%E6%9E%84"><span class="nav-text">嵌套解构</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E8%A7%A3%E6%9E%84"><span class="nav-text">数组解构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A8%A1%E6%8B%9F%E5%AF%B9%E8%B1%A1"><span class="nav-text">模拟对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E8%87%AA%E5%B7%B1%E7%9A%84%E7%BB%93%E6%9E%84"><span class="nav-text">数组自己的结构</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%84"><span class="nav-text">参数解构</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%A6%E5%8F%B7"><span class="nav-text">符号</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%99%AE%E9%80%9A%E7%AC%A6%E5%8F%B7"><span class="nav-text">普通符号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E7%AC%A6%E5%8F%B7"><span class="nav-text">共享符号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E5%90%8D%E7%AC%A6%E5%8F%B7"><span class="nav-text">知名符号</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86"><span class="nav-text">异步处理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF"><span class="nav-text">事件循环</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E6%A0%88%EF%BC%9A"><span class="nav-text">执行栈：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%82%E6%AD%A5%E5%87%BD%E6%95%B0%EF%BC%9A"><span class="nav-text">异步函数：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AE%BF%E4%B8%BB%E7%8E%AF%E5%A2%83%E4%B8%AD%E5%8C%85%E5%90%AB-5-%E4%B8%AA%E7%BA%BF%E7%A8%8B%EF%BC%9A"><span class="nav-text">浏览器宿主环境中包含 5 个线程：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MutationObserver-%E7%94%A8%E4%BA%8E%E7%9B%91%E5%90%AC%E6%9F%90%E4%B8%AA-DOM-%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%8F%98%E5%8C%96"><span class="nav-text">MutationObserver 用于监听某个 DOM 对象的变化</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86%E7%9A%84%E9%80%9A%E7%94%A8%E6%A8%A1%E5%9E%8B"><span class="nav-text">异步处理的通用模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Promise-%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-text">Promise 的基本用法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%BC%E5%BC%8F%EF%BC%9A"><span class="nav-text">格式：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%86%E8%8A%82"><span class="nav-text">细节</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Promise-%E7%9A%84%E4%B8%B2%E8%81%94"><span class="nav-text">Promise 的串联</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Promise-%E5%AF%B9%E8%B1%A1%E4%B8%AD%EF%BC%8C%E6%97%A0%E8%AE%BA%E6%98%AF-then-%E6%96%B9%E6%B3%95%E8%BF%98%E6%98%AF-catch-%E6%96%B9%E6%B3%95%EF%BC%8C%E5%AE%83%E4%BB%AC%E9%83%BD%E5%85%B7%E6%9C%89%E8%BF%94%E5%9B%9E%E5%80%BC%EF%BC%8C%E8%BF%94%E5%9B%9E%E7%9A%84%E6%98%AF%E4%B8%80%E4%B8%AA%E5%85%A8%E6%96%B0%E7%9A%84-Promise-%E5%AF%B9%E8%B1%A1%EF%BC%8C%E5%AE%83%E7%9A%84%E7%8A%B6%E6%80%81%E6%BB%A1%E8%B6%B3%E4%B8%8B%E9%9D%A2%E7%9A%84%E8%A7%84%E5%88%99%EF%BC%9A"><span class="nav-text">Promise 对象中，无论是 then 方法还是 catch 方法，它们都具有返回值，返回的是一个全新的 Promise 对象，它的状态满足下面的规则：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Promise-%E7%9A%84%E5%85%B6%E4%BB%96-api"><span class="nav-text">Promise 的其他 api</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E5%9E%8B%E6%88%90%E5%91%98-%E5%AE%9E%E4%BE%8B%E6%88%90%E5%91%98"><span class="nav-text">原型成员 (实例成员)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%88%90%E5%91%98-%EF%BC%88%E9%9D%99%E6%80%81%E6%88%90%E5%91%98%EF%BC%89"><span class="nav-text">构造函数成员 （静态成员）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#async-%E5%92%8C-await"><span class="nav-text">async 和 await</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#async"><span class="nav-text">async</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#await"><span class="nav-text">await</span></a></li></ol></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Ethan"
      src="/135xyq.github.io/images/avatar.jpeg">
  <p class="site-author-name" itemprop="name">Ethan</p>
  <div class="site-description" itemprop="description">Ethan的博客</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/135xyq.github.io/archives/">
          <span class="site-state-item-count">134</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/135xyq.github.io/categories/">
        <span class="site-state-item-count">61</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/135xyq.github.io/tags/">
        <span class="site-state-item-count">52</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button site-overview-item animated">
    <button><i class="fa fa-comment"></i>
      Chat
    </button>
  </div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/135xyq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;135xyq" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:xyq135@gmail.com" title="E-Mail → mailto:xyq135@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/7158635451" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;7158635451" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://plus.google.com/%E8%B0%A2%E6%B0%B8%E5%BC%BA" title="Google → https:&#x2F;&#x2F;plus.google.com&#x2F;谢永强" rel="noopener" target="_blank"><i class="fab fa-google fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/yongqiangxie1" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;yongqiangxie1" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i></a>
      </span>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/135xyq" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://135xyq.github.io/135xyq.github.io/2021/03/20/ES6-%E8%A7%A3%E6%9E%84_%E7%AC%A6%E5%8F%B7_%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/135xyq.github.io/images/avatar.jpeg">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="Ethan的博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ethan">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ES6中的解构 符号 异步处理
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-03-20 16:21:22" itemprop="dateCreated datePublished" datetime="2021-03-20T16:21:22+08:00">2021-03-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-08-16 15:15:44" itemprop="dateModified" datetime="2022-08-16T15:15:44+08:00">2022-08-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/135xyq.github.io/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">前端学习笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/135xyq.github.io/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/ES6/" itemprop="url" rel="index"><span itemprop="name">ES6</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/135xyq.github.io/2021/03/20/ES6-%E8%A7%A3%E6%9E%84_%E7%AC%A6%E5%8F%B7_%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86/#SOHUCS" itemprop="discussionUrl">
        <span id="changyan_count_unit" class="post-comments-count hc-comment-count" data-xid="2021/03/20/ES6-解构_符号_异步处理/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>6.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>6 分钟</span>
    </span>
</div>

            <div class="post-description">数组和对象解构的介绍、符号这一新增数据类型的介绍和使用场景，js中异步处理的原理的使用</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="解构-符号-异步处理"><a href="#解构-符号-异步处理" class="headerlink" title="解构 符号 异步处理"></a>解构 符号 异步处理</h1><hr>
<h2 id="解构"><a href="#解构" class="headerlink" title="解构"></a>解构</h2><p>将数组或对象的某一属性提取到变量中(可以互相嵌套使用)<br>可以给结构出来的变量赋默认值（变量名 = 默认值）</p>
<h3 id="对象解构"><a href="#对象解构" class="headerlink" title="对象解构"></a>对象解构</h3><h4 id="解构剩余参数："><a href="#解构剩余参数：" class="headerlink" title="解构剩余参数："></a>解构剩余参数：</h4><p>将剩余的所有参数都敢放到一个数组或对象中（使用展开运算符）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> [nn1, ...arr1] = arr;</span><br><span class="line"><span class="built_in">console</span>.log(nn1, arr1);</span><br><span class="line"><span class="comment">// 将第一个结构出来，其他放到arr1 数组中</span></span><br></pre></td></tr></table></figure>

<h4 id="同名解构（变量名要和属性名一致）"><a href="#同名解构（变量名要和属性名一致）" class="headerlink" title="同名解构（变量名要和属性名一致）"></a>同名解构（变量名要和属性名一致）</h4><h5 id="语法："><a href="#语法：" class="headerlink" title="语法："></a>语法：</h5><ul>
<li>  先定义再解构变量：（{变量名，…..} = 对象名）</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">	<span class="attr">name</span>: <span class="string">&quot;xyq&quot;</span>,</span><br><span class="line">	<span class="attr">sex</span>: <span class="string">&quot;male&quot;</span>,</span><br><span class="line">	<span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">	<span class="attr">address</span>: &#123;</span><br><span class="line">		<span class="attr">province</span>: <span class="string">&quot;河南&quot;</span>,</span><br><span class="line">		<span class="attr">city</span>: <span class="string">&quot;驻马店&quot;</span>,</span><br><span class="line">	&#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> name, age;</span><br><span class="line"></span><br><span class="line">(&#123; name, age &#125; = obj);</span><br><span class="line"><span class="built_in">console</span>.log(name, age);</span><br></pre></td></tr></table></figure>

<ul>
<li>  直接解构 ： let / const / var {变量名} = 对象名</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对象解构</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">	<span class="attr">name</span>: <span class="string">&quot;xyq&quot;</span>,</span><br><span class="line">	<span class="attr">sex</span>: <span class="string">&quot;male&quot;</span>,</span><br><span class="line">	<span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">	<span class="attr">address</span>: &#123;</span><br><span class="line">		<span class="attr">province</span>: <span class="string">&quot;河南&quot;</span>,</span><br><span class="line">		<span class="attr">city</span>: <span class="string">&quot;驻马店&quot;</span>,</span><br><span class="line">	&#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123; name, sex, age, address &#125; = obj;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(t, sex, age, address);</span><br></pre></td></tr></table></figure>

<h4 id="异名解构"><a href="#异名解构" class="headerlink" title="异名解构"></a>异名解构</h4><p>```{属性名：变量名}`````</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将name解构成变量t</span></span><br><span class="line"><span class="keyword">let</span> &#123; name, <span class="attr">age</span>: t &#125; = obj;</span><br><span class="line"><span class="built_in">console</span>.log(name, t);</span><br></pre></td></tr></table></figure>

<h4 id="嵌套解构"><a href="#嵌套解构" class="headerlink" title="嵌套解构"></a>嵌套解构</h4><p><code>&#123;属性名：&#123;属性名&#125;</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123;</span><br><span class="line">	name,</span><br><span class="line">	<span class="attr">address</span>: &#123; city &#125;,</span><br><span class="line">&#125; = obj;</span><br><span class="line"><span class="comment">// 此时address为 undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(city);</span><br></pre></td></tr></table></figure>

<h3 id="数组解构"><a href="#数组解构" class="headerlink" title="数组解构"></a>数组解构</h3><h4 id="模拟对象"><a href="#模拟对象" class="headerlink" title="模拟对象"></a>模拟对象</h4><p>数组可以看成特殊的对象，可以参考对象的异名解构</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> &#123; <span class="number">0</span>: n1, <span class="number">1</span>: n2 &#125; = arr;</span><br><span class="line"><span class="built_in">console</span>.log(n1, n2);</span><br></pre></td></tr></table></figure>

<h4 id="数组自己的结构"><a href="#数组自己的结构" class="headerlink" title="数组自己的结构"></a>数组自己的结构</h4><p>[变量名，，，，，变量名],按顺序结构数组，不想结构的对象用空格空出</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> [n1, n2, , n4] = arr;</span><br><span class="line"><span class="built_in">console</span>.log(n1, n2, n4);</span><br></pre></td></tr></table></figure>

<h3 id="参数解构"><a href="#参数解构" class="headerlink" title="参数解构"></a>参数解构</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//常用于函数参数的定义</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">&#123; method = <span class="string">&quot;get&quot;</span>, url = <span class="string">&quot;/&quot;</span> &#125; = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(method, url);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ajax();</span><br></pre></td></tr></table></figure>

<h2 id="符号"><a href="#符号" class="headerlink" title="符号"></a>符号</h2><p>对象的属性名一定是一个字符串</p>
<h3 id="普通符号"><a href="#普通符号" class="headerlink" title="普通符号"></a>普通符号</h3><p>符号是 ES6 新增的一个数据类型，它通过使用函数 <code>Symbol(符号描述)</code> 来创建</p>
<p>符号设计的初衷，是为了给对象设置私有属性</p>
<p>私有属性：只能在对象内部使用，外面无法使用</p>
<p>符号具有以下特点：</p>
<ul>
<li>  没有字面量</li>
<li>  使用 typeof 得到的类型是 symbol</li>
<li>  <strong>每次调用 Symbol 函数得到的符号永远不相等，无论符号名是否相同</strong></li>
<li>符号可以作为对象的属性名存在，这种属性称之为符号属性<ul>
<li>  开发者可以通过精心的设计，让这些属性无法通过常规方式被外界访问</li>
<li>  符号属性是不能枚举的，因此在 for-in 循环中无法读取到符号属性，Object.keys 方法也无法读取到符号属性</li>
<li>  Object.getOwnPropertyNames 尽管可以得到所有无法枚举的属性，但是仍然无法读取到符号属性</li>
<li>  ES6 新增 Object.getOwnPropertySymbols 方法，可以读取符号</li>
</ul>
</li>
<li>  符号无法被隐式转换，因此不能被用于数学运算、字符串拼接或其他隐式转换的场景，但符号可以显式的转换为字符串，通过 String 构造函数进行转换即可，console.log 之所以可以输出符号，是它在内部进行了显式转换</li>
</ul>
<h3 id="共享符号"><a href="#共享符号" class="headerlink" title="共享符号"></a>共享符号</h3><p>根据某个符号名称（符号描述）能够得到同一个符号</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Symbol</span>.for(<span class="string">&quot;符号名/符号描述&quot;</span>); <span class="comment">//获取共享符号</span></span><br></pre></td></tr></table></figure>

<h3 id="知名符号"><a href="#知名符号" class="headerlink" title="知名符号"></a>知名符号</h3><p>知名符号是一些具有特殊含义的共享符号，通过 Symbol 的静态属性得到</p>
<p>ES6 延续了 ES5 的思想：减少魔法，暴露内部实现！</p>
<p>因此，ES6 用知名符号暴露了某些场景的内部实现</p>
<ol>
<li>Symbol.hasInstance</li>
</ol>
<p>该符号用于定义构造函数的静态成员，它将影响 instanceof 的判定</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">obj <span class="keyword">instanceof</span> A;</span><br><span class="line"></span><br><span class="line"><span class="comment">//等效于</span></span><br><span class="line"></span><br><span class="line">A[<span class="built_in">Symbol</span>.hasInstance](obj); <span class="comment">// Function.prototype[Symbol.hasInstance]</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>Symbol.isConcatSpreadable</li>
</ol>
<p>该知名符号会影响数组的 concat 方法</p>
<ol start="3">
<li>Symbol.toPrimitive</li>
</ol>
<p>该知名符号会影响类型转换的结果</p>
<ol start="4">
<li>Symbol.toStringTag</li>
</ol>
<p>该知名符号会影响 Object.prototype.toString 的返回值</p>
<h2 id="异步处理"><a href="#异步处理" class="headerlink" title="异步处理"></a>异步处理</h2><h3 id="事件循环"><a href="#事件循环" class="headerlink" title="事件循环"></a>事件循环</h3><p>JS 运行的环境称之为宿主环境。</p>
<h4 id="执行栈："><a href="#执行栈：" class="headerlink" title="执行栈："></a>执行栈：</h4><p>call stack，一个数据结构，用于存放各种函数的执行环境，每一个函数执行之前，它的相关信息会加入到执行栈。函数调用之前，创建执行环境，然后加入到执行栈；函数调用之后，销毁执行环境。</p>
<p>JS 引擎永远执行的是执行栈的最顶部。</p>
<h4 id="异步函数："><a href="#异步函数：" class="headerlink" title="异步函数："></a>异步函数：</h4><p>某些函数不会立即执行，需要等到某个时机到达后才会执行，这样的函数称之为异步函数。比如事件处理函数。异步函数的执行时机，会被宿主环境控制。</p>
<h4 id="浏览器宿主环境中包含-5-个线程："><a href="#浏览器宿主环境中包含-5-个线程：" class="headerlink" title="浏览器宿主环境中包含 5 个线程："></a>浏览器宿主环境中包含 5 个线程：</h4><ol>
<li>JS 引擎：负责执行执行栈的最顶部代码</li>
<li>GUI 线程：负责渲染页面</li>
<li>事件监听线程：负责监听各种事件</li>
<li>计时线程：负责计时</li>
<li>网络线程：负责网络通信</li>
</ol>
<p>当上面的线程发生了某些事请，如果该线程发现，这件事情有处理程序，它会将该处理程序加入一个叫做事件队列的内存。当 JS 引擎发现，执行栈中已经没有了任何内容后，会将事件队列中的第一个函数加入到执行栈中执行。</p>
<p>JS 引擎对事件队列的取出执行方式，以及与宿主环境的配合，称之为事件循环。</p>
<p>事件队列在不同的宿主环境中有所差异，大部分宿主环境会将事件队列进行细分。在浏览器中，事件队列分为两种：</p>
<ul>
<li>  宏任务（队列）：macroTask，计时器结束的回调、事件回调、http 回调等等绝大部分异步函数进入宏队列</li>
<li>  微任务（队列）：MutationObserver，Promise 产生的回调进入微队列</li>
</ul>
<h4 id="MutationObserver-用于监听某个-DOM-对象的变化"><a href="#MutationObserver-用于监听某个-DOM-对象的变化" class="headerlink" title="MutationObserver 用于监听某个 DOM 对象的变化"></a>MutationObserver 用于监听某个 DOM 对象的变化</h4><p>当执行栈清空时，JS 引擎首先会将微任务中的所有任务依次执行结束，如果没有微任务，则执行宏任务。</p>
<h3 id="异步处理的通用模型"><a href="#异步处理的通用模型" class="headerlink" title="异步处理的通用模型"></a>异步处理的通用模型</h3><p>ES 官方参考了大量的异步场景，总结出了一套异步的通用模型，该模型可以覆盖几乎所有的异步场景，甚至是同步场景。</p>
<p>值得注意的是，为了兼容旧系统，ES6 并不打算抛弃掉过去的做法，只是基于该模型推出一个全新的 API，使用该 API，会让异步处理更加的简洁优雅。</p>
<p>理解该 API，最重要的，是理解它的异步模型</p>
<ol>
<li>ES6 将某一件可能发生异步操作的事情，分为两个阶段：<strong>unsettled</strong> 和 <strong>settled</strong></li>
</ol>
<p><img src="/images/ES6/%E8%A7%A3%E6%9E%84_%E7%AC%A6%E5%8F%B7_%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86-%E4%B8%A4%E4%B8%AA%E9%98%B6%E6%AE%B5.jpg"></p>
<ul>
<li>  unsettled： 未决阶段，表示事情还在进行前期的处理，并没有发生通向结果的那件事</li>
<li>  settled：已决阶段，事情已经有了一个结果，不管这个结果是好是坏，整件事情无法逆转</li>
</ul>
<p>事情总是从 未决阶段 逐步发展到 已决阶段的。并且，未决阶段拥有控制何时通向已决阶段的能力。</p>
<ol start="2">
<li>ES6 将事情划分为三种状态： pending、resolved、rejected</li>
</ol>
<ul>
<li>  pending: 挂起，处于未决阶段，则表示这件事情还在挂起（最终的结果还没出来）</li>
<li>  resolved：已处理，已决阶段的一种状态，表示整件事情已经出现结果，并是一个可以按照正常逻辑进行下去的结果</li>
<li>  rejected：已拒绝，已决阶段的一种状态，表示整件事情已经出现结果，并是一个无法按照正常逻辑进行下去的结果，通常用于表示有一个错误</li>
</ul>
<p>既然未决阶段有权力决定事情的走向，因此，未决阶段可以决定事情最终的状态！</p>
<p>我们将 把事情变为 resolved 状态的过程叫做：<strong>resolve</strong>，推向该状态时，可能会传递一些数据</p>
<p>我们将 把事情变为 rejected 状态的过程叫做：<strong>reject</strong>，推向该状态时，同样可能会传递一些数据，通常为错误信息</p>
<p><strong>始终记住，无论是阶段，还是状态，是不可逆的！</strong></p>
<p><img src="/images/ES6/%E8%A7%A3%E6%9E%84_%E7%AC%A6%E5%8F%B7_%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86-%E4%B8%A4%E4%B8%AA%E9%98%B6%E6%AE%B5%E7%9A%84%E8%BD%AC%E6%8D%A2.jpg"></p>
<ol start="3">
<li>当事情达到已决阶段后，通常需要进行后续处理，不同的已决状态，决定了不同的后续处理。</li>
</ol>
<ul>
<li>  resolved 状态：这是一个正常的已决状态，后续处理表示为 thenable</li>
<li>  rejected 状态：这是一个非正常的已决状态，后续处理表示为 catchable</li>
</ul>
<p>后续处理可能有多个，因此会形成作业队列，这些后续处理会按照顺序，当状态到达后依次执行</p>
<p><img src="/images/ES6/%E8%A7%A3%E6%9E%84_%E7%AC%A6%E5%8F%B7_%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86-%E5%90%8E%E7%BB%AD%E5%A4%84%E7%90%86%E7%8A%B6%E6%80%81.jpg"></p>
<ol start="4">
<li>整件事称之为 Promise</li>
</ol>
<p><img src="/images/ES6/%E8%A7%A3%E6%9E%84_%E7%AC%A6%E5%8F%B7_%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86-Promise.jpg"></p>
<h3 id="Promise-的基本用法"><a href="#Promise-的基本用法" class="headerlink" title="Promise 的基本用法"></a>Promise 的基本用法</h3><h4 id="格式："><a href="#格式：" class="headerlink" title="格式："></a>格式：</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pro = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">	<span class="comment">// 未决阶段的处理</span></span><br><span class="line">	<span class="comment">// 通过调用resolve函数将Promise推向已决阶段的resolved状态</span></span><br><span class="line">	<span class="comment">// 通过调用reject函数将Promise推向已决阶段的rejected状态</span></span><br><span class="line">	<span class="comment">// resolve和reject均可以传递最多一个参数，表示推向状态的数据</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">pro.then(</span><br><span class="line">	<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">//这是thenable函数，如果当前的Promise已经是resolved状态，该函数会立即执行</span></span><br><span class="line">		<span class="comment">//如果当前是未决阶段，则会加入到作业队列，等待到达resolved状态后执行</span></span><br><span class="line">		<span class="comment">//data为状态数据</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">//这是catchable函数，如果当前的Promise已经是rejected状态，该函数会立即执行</span></span><br><span class="line">		<span class="comment">//如果当前是未决阶段，则会加入到作业队列，等待到达rejected状态后执行</span></span><br><span class="line">		<span class="comment">//err为状态数据</span></span><br><span class="line">	&#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="细节"><a href="#细节" class="headerlink" title="细节"></a>细节</h4><ol>
<li>未决阶段的处理函数是同步的，会立即执行</li>
<li>thenable 和 catchable 函数是异步的，就算是立即执行，也会加入到事件队列中等待执行，并且，加入的队列是微队列</li>
<li>pro.then 可以只添加 thenable 函数，pro.catch 可以单独添加 catchable 函数</li>
<li>在未决阶段的处理函数中，如果发生未捕获的错误，会将状态推向 rejected，并会被 catchable 捕获</li>
<li>一旦状态推向了已决阶段，无法再对状态做任何更改</li>
<li><strong>Promise 并没有消除回调，只是让回调变得可控</strong></li>
</ol>
<h3 id="Promise-的串联"><a href="#Promise-的串联" class="headerlink" title="Promise 的串联"></a>Promise 的串联</h3><p>当后续的 Promise 需要用到之前的 Promise 的处理结果时，需要 Promise 的串联</p>
<h4 id="Promise-对象中，无论是-then-方法还是-catch-方法，它们都具有返回值，返回的是一个全新的-Promise-对象，它的状态满足下面的规则："><a href="#Promise-对象中，无论是-then-方法还是-catch-方法，它们都具有返回值，返回的是一个全新的-Promise-对象，它的状态满足下面的规则：" class="headerlink" title="Promise 对象中，无论是 then 方法还是 catch 方法，它们都具有返回值，返回的是一个全新的 Promise 对象，它的状态满足下面的规则："></a>Promise 对象中，无论是 then 方法还是 catch 方法，它们都具有返回值，返回的是一个全新的 Promise 对象，它的状态满足下面的规则：</h4><ol>
<li>如果当前的 Promise 是未决的，得到的新的 Promise 是挂起状态</li>
<li>如果当前的 Promise 是已决的，会运行相应的后续处理函数，并将后续处理函数的结果（返回值）作为 resolved 状态数据，应用到新的 Promise 中；如果后续处理函数发生错误，则把返回值作为 rejected 状态数据，应用到新的 Promise 中。</li>
</ol>
<p><strong>后续的 Promise 一定会等到前面的 Promise 有了后续处理结果后，才会变成已决状态</strong></p>
<p>如果前面的 Promise 的后续处理，返回的是一个 Promise，则返回的新的 Promise 状态和后续处理返回的 Promise 状态保持一致。</p>
<h3 id="Promise-的其他-api"><a href="#Promise-的其他-api" class="headerlink" title="Promise 的其他 api"></a>Promise 的其他 api</h3><h4 id="原型成员-实例成员"><a href="#原型成员-实例成员" class="headerlink" title="原型成员 (实例成员)"></a>原型成员 (实例成员)</h4><ul>
<li>  then：注册一个后续处理函数，当 Promise 为 resolved 状态时运行该函数</li>
<li>  catch：注册一个后续处理函数，当 Promise 为 rejected 状态时运行该函数</li>
<li>  finally：[ES2018]注册一个后续处理函数（无参），当 Promise 为已决时运行该函数</li>
</ul>
<h4 id="构造函数成员-（静态成员）"><a href="#构造函数成员-（静态成员）" class="headerlink" title="构造函数成员 （静态成员）"></a>构造函数成员 （静态成员）</h4><ul>
<li><p>resolve(数据)：该方法返回一个 resolved 状态的 Promise，传递的数据作为状态数据</p>
<ul>
<li>  特殊情况：如果传递的数据是 Promise，则直接返回传递的 Promise 对象</li>
</ul>
</li>
<li><p>  reject(数据)：该方法返回一个 rejected 状态的 Promise，传递的数据作为状态数据</p>
</li>
<li><p>  all(iterable)：这个方法返回一个新的 promise 对象，该 promise 对象在 iterable 参数对象里所有的 promise 对象都成功的时候才会触发成功，一旦有任何一个 iterable 里面的 promise 对象失败则立即触发该 promise 对象的失败。这个新的 promise 对象在触发成功状态以后，会把一个包含 iterable 里所有 promise 返回值的数组作为成功回调的返回值，顺序跟 iterable 的顺序保持一致；如果这个新的 promise 对象触发了失败状态，它会把 iterable 里第一个触发失败的 promise 对象的错误信息作为它的失败错误信息。Promise.all 方法常被用于处理多个 promise 对象的状态集合。</p>
</li>
<li><p>  race(iterable)：当 iterable 参数里的任意一个子 promise 被成功或失败后，父 promise 马上也会用子 promise 的成功返回值或失败详情作为参数调用父 promise 绑定的相应句柄，并返回该 promise 对象</p>
</li>
</ul>
<h3 id="async-和-await"><a href="#async-和-await" class="headerlink" title="async 和 await"></a>async 和 await</h3><p>async 和 await 是 ES2016 新增两个关键字，它们借鉴了 ES2015 中生成器在实际开发中的应用，目的是简化 Promise api 的使用，并非是替代 Promise。</p>
<h4 id="async"><a href="#async" class="headerlink" title="async"></a>async</h4><p>目的是简化在函数的返回值中对 Promise 的创建</p>
<p>async 用于修饰函数（无论是函数字面量还是函数表达式），放置在函数最开始的位置，被修饰函数的返回结果一定是 Promise 对象。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//等效于</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">		resolve(<span class="number">2</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="await"><a href="#await" class="headerlink" title="await"></a>await</h4><p><strong>await 关键字必须出现在 async 函数中！！！！</strong></p>
<p>await 用在某个表达式之前，如果表达式是一个 Promise，则得到的是 thenable 中的状态数据。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> result = <span class="keyword">await</span> test1();</span><br><span class="line">	<span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test2();</span><br></pre></td></tr></table></figure>

<p>等效于</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">		resolve(<span class="number">2</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">		test1().then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">			<span class="keyword">const</span> result = data;</span><br><span class="line">			<span class="built_in">console</span>.log(result);</span><br><span class="line">			resolve();</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test2();</span><br></pre></td></tr></table></figure>

<p>如果 await 的表达式不是 Promise，则会将其使用 Promise.resolve 包装后按照规则运行</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/135xyq.github.io/./images/wechatpay.png" alt="Ethan 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="/135xyq.github.io/images/alipay.jpg" alt="Ethan 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          <div class="followme">
  <span>欢迎关注我的其它发布渠道</span>

  <div class="social-list">

      <div class="social-item">
        <a target="_blank" class="social-link" href="https://twitter.com/yongqiangxie1">
          <span class="icon">
            <i class="fab fa-twitter"></i>
          </span>

          <span class="label">Twitter</span>
        </a>
      </div>

      <div class="social-item">
        <a target="_blank" class="social-link" href="/135xyq.github.io/images/wechat_channel.png">
          <span class="icon">
            <i class="fab fa-weixin"></i>
          </span>

          <span class="label">WeChat</span>
        </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/135xyq.github.io/tags/%E5%89%8D%E7%AB%AF/" rel="tag"><i class="fa fa-tag"></i> 前端</a>
              <a href="/135xyq.github.io/tags/ES6/" rel="tag"><i class="fa fa-tag"></i> ES6</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/135xyq.github.io/2021/03/16/ES6-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" rel="prev" title="ES6中的面向对象和面向过程的比较">
                  <i class="fa fa-chevron-left"></i> ES6中的面向对象和面向过程的比较
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/135xyq.github.io/2021/03/23/ES6-%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/" rel="next" title="迭代器和生成器">
                  迭代器和生成器 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="SOHUCS"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ethan</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">1.4m 字</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">20:31</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i> 总访客量:
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i> 总访问次数:
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<div>
<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
var now = new Date();
function createtime() {
	var grt = new Date("11/11/2020 12:00:00");
	now.setTime(now.getTime() + 250);
	days = Math.floor((now - grt) / 1000 / 60 / 60 / 24);
	hours = Math.floor((now - grt) / 1000 / 60 / 60 - 24 * days);
	if (String(hours).length == 1) {
		hours = "0" + hours;
	}
	minutes = Math.floor((now - grt) / 1000 / 60 - 24 * 60 * days - 60 * hours);
	if (minutes.length == 1) {
		minutes = "0" + minutes;
	}
	seconds = Math.round(
		(now - grt) / 1000 - 24 * 60 * 60 * days - 60 * 60 * hours - 60 * minutes
	);
	if (String(seconds).length == 1) {
		seconds = "0" + seconds;
	}
    document.getElementById("timeDate").innerHTML = "本站已安全运行 "+days+" 天 ";
    document.getElementById("times").innerHTML = hours + " 小时 " + minutes + " 分 " + seconds + " 秒";
}

setInterval("createtime()",250)
</script>

</div>

<div>
  <button id="mylove"
      style="background-color:black;color: #fff;margin-top:30px;cursor: pointer;outline: none; border-radius: 5px;padding: 6px 15px;">触发彩蛋</button>
</div>
 <div class="alert-input" id="alertInput">
    <p>请输入作者喜欢女生的名字</p>
    <input type="text" id="inputLover" placeholder="输入正确答案才会触发" autofocus>
    <div class="btns">
      <button class="cancel-button" id="cancel">取消</button>
      <button class="confirm-button" id="confirm">确定</button>
    </div>
  </div>
<canvas id="mycanvas"></canvas>
  <div class="name" id="name"></div>
<style>
    #mylove {
      background-color: black;
      color: #fff;
      cursor: pointer;
      outline: none;
      border-radius: 5px;
      padding: 5px 15px;
    }

    .confirm {
      background-color: #f00;
    }

    #pinkboard {
      display: none;
    }

    .alert-input {
      padding: 10px;
      width: 250px;
      border-radius: 10px;
      text-align: center;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      box-shadow: 3px 3px 10px #d2cfcf;
      display: none;
    }

    .btns {
      margin-top: 20px;
    }

    .confirm-button,
    .cancel-button {
      background-color: #000;
      color: #fff;
      outline: none;
      margin-left: 5px;
      cursor: pointer;
      padding: 5px 15px;
      border-radius: 5px;
      border: none;
    }

    .cancel-button {
      background-color: rgb(175, 19, 19);
    }

    #inputLover {
      outline: none;
      height: 25px;
      font-size: 13px;
      text-indent: 5px;
      border: 1px solid #ddd;
    }

    html,
        body {
            height: 100%;
            padding: 0;
            margin: 0;
        }

    canvas {
     position: fixed;
     top:0px;
     left:0px;
      width: 100%;
      height: 100%;
    }
        .name {
      display: none;
    position: fixed;
    left: 46%;
    top: 50%;
          color: #c147b1;
    }

  </style>
 <script>
    document.getElementById("mylove").onclick = alertOneInput;
    const alertInput = document.getElementById("alertInput");
    const cancelBtn = document.getElementById("cancel");
    const confirmBtn = document.getElementById("confirm");
    const input = document.getElementById("inputLover");
    const mycanvas = document.getElementById("mycanvas");
    const name = document.getElementById("name");

    function alertOneInput() {
      alertInput.style.display = "block";
      alertInput.focus();
    }
    cancelBtn.onclick = function close() {
      input.value = ""
      alertInput.style.display = "none";
    }
    confirmBtn.onclick = function confirm() {
      const result = input.value.trim();
      if (result === "") {
        alert("咋回事？居然不输入东西！")
      } else if (result === "黄双珍") {
        mycanvas.style.display = "block";
        showLover()
        loop();
        name.style.display = "block"
        input.value = "";
        alertInput.style.display = "none";
        setTimeout(() => {
          mycanvas.style.display = "none";
          name.style.display = "none"
        }, 30000)
      } else {
        alert("小老弟，你还是不了解我，要不还是算了吧？")
        input.value = ""
      }
    }

  </script>
 <script>
 window.requestAnimationFrame=(function(){
    return window.requestAnimationFrame||
      window.webkitRequestAnimationFrame||
      window.mozRequestAnimationFrame||
      function (callback){
        window.setTimeout(callback,1000)
        //每间隔10秒执行一次动画
      }
  })();
  //获取canvas区域.并设置宽和高
  var area=document.getElementById("mycanvas");
  area.width=document.documentElement.clientWidth;
  area.height=document.documentElement.clientHeight;
  //转换成2d模型
  var ctx=area.getContext("2d");
  //烟花数组
  hue=120;//设置颜色范围
  timerTick = 0;//计时器
  timerTotal=5;//每间隔5秒烟花绽放一次
  fireworks=[];//存放烟花数组
  particles=[];//存放碎屑数组
  //随机min和max之间的值
  function random(min,max){
    return Math.random()*(max-min)+min;
  }
  //计算两点之间的距离
  function distans(sx,sy,tx,ty){
    var xdistan=sx-tx;
    var ydistan=sy-ty;
    return Math.sqrt((Math.pow(xdistan,2)+Math.pow(ydistan,2)));
  }
  //定义烟花对象
  function Firework(sx,sy,tx,ty){
    this.x=sx;
    this.y=sy;
    this.sx=sx;
    this.sy=sy;
    this.tx=tx;
    this.ty=ty;
    //计算两点之间的距离
    this.targetDistances=distans(sx,sy,tx,ty);
    //运行距离
    this.distancesc=0;
    //定义变量生成的运动轨迹
    this.guiji=[];
    this.guijicount=3;
    while(this.guijicount--){
      this.guiji.push([this.x,this.y]);
    }
    //计算角度
    this.angle=Math.atan2(ty-sy,tx-sx);
    this.speed=2;
    this.jiasudu=1.05;
    this.brightness=random(50,70);//烟花的明度
    this.targetRad=5;//烟花小圈的半径
  }
  //更新烟花的位置
  Firework.prototype.update=function(index){
    this.guiji.pop();
    this.guiji.push([this.x,this.y]);
    //目标圆运动
    if(this.targetRad<8){
      this.targetRad+=0.3;
    }else{
      this.targetRad=1;
    }
    //根据加速度计算速度并且计算出烟花运行过程中x轴和y轴的速度
    this.speed*=this.jiasudu;
    var vx=Math.cos(this.angle)*this.speed;
    var vy=Math.sin(this.angle)*this.speed;
    //重新计算两点之间的距离
    this.distancesc=distans(this.sx,this.sy,this.x+vx,this.y+vy);
    //如果烟花运行距离大于或等于初始位置到目标位置之间的距离，生成新烟花并移除当前烟花，否则更新烟花位置
    if(this.distancesc>=this.targetDistances){
      //生成烟花碎屑
      createparticals(this.tx,this.ty);
      //销毁烟花小圈
      fireworks.splice(index,1)
    }else{
      this.x+=vx;
      this.y+=vy;
    }
  }
  
  //开始画运行轨迹
  Firework.prototype.draw=function(){
    ctx.beginPath();
    //轨迹的起点
    ctx.moveTo(this.guiji[this.guiji.length-1][0],this.guiji[this.guiji.length-1][1]);
    //绘制线条到目标点
    ctx.lineTo(this.x,this.y);
    //画出不同颜色的烟花
    ctx.strokeStyle='hsl('+hue+',100%,'+this.brightness+'%)';
    ctx.stroke();//绘制烟花轨迹
    //画出目标小圆
    ctx.beginPath();
    ctx.arc(this.tx,this.ty,this.targetRad,0,Math.PI*2);
    ctx.stroke();
  }
  //定义烟花碎屑方法
  function Particle(x, y) {
    this.x = x;
    this.y = y;
    this.guiji = [];
    this.guijicount = 10;
    while(this.guijicount--){
      this.guiji.push([this.x,this.y]);
    }
    //生成任意方向的碎屑
    this.angle=random(0 , 2*Math.PI);
    this.speed=random(1,10);//随机的速度
    this.mocal=0.95;//摩擦力
    this.gravity=0.98;//重力
    this.hue=random(hue-20,hue+20);//碎屑颜色变化范围
    this.brightness=random(50,80);
    this.alpha=1;//定义碎屑初始不透明
    this.decay=random(0.015,0.03);//碎屑消失的时间
  }
  //更新碎屑
  Particle.prototype.update=function(index){
    this.guiji.pop();
    //unshift() 方法可向数组的开头添加一个或更多元素，并返回新的长度。
    this.guiji.unshift([this.x,this.y]);
    //下面是烟花碎屑的运动
    this.speed*=this.mocal;
    this.x+=Math.cos(this.angle)*this.speed;
    this.y+=Math.sin(this.angle)*this.speed+this.gravity;
    this.alpha-=this.decay;//不透明度一直随时间变为0；即烟花碎屑消失
    if(this.alpha<=this.decay){
      particles.splice(index,1)//销毁烟花碎屑
    }
  }
  //画烟花碎屑轨迹
  Particle.prototype.draw=function(){
    ctx.beginPath();
    ctx.moveTo(this.guiji[this.guiji.length-1][0],this.guiji[this.guiji.length-1][1]);
    ctx.lineTo(this.x,this.y);
    //画出不同颜色的烟花利用HSL
    ctx.strokeStyle='hsl('+hue+',100%,'+this.brightness+'%)';
    ctx.stroke();
  }
  //创建碎屑
  function createparticals(x,y){
    //设定碎屑数目
    var particalcount=500;
    while(particalcount--){
      //随着碎屑数目的减少为0，又重新调用碎屑方法
      particles.push(new Particle(x,y))
    }
  }
  //获取屏幕的宽和高
  var clientw=document.documentElement.clientWidth;
  var clienth=document.documentElement.clientHeight;
  function loop(){
    //requestAnimationFrame() 方法来告诉浏览器需要执行的动画，
    // 并让浏览器在下一次重绘之前调用指定的函数来更新动画。
    requestAnimationFrame(loop);
    hue+=0.5;
    //在源图像外显示目标图像。只有源图像外的目标图像部分会被显示，源图像是透明的。
    ctx.globalCompositeOperation = 'destination-out';
    ctx.fillRect(0,0,clientw,clienth);
    ctx.fillStyle='rgb(0,0,0,0.5)';
    //显示源图像和目标图像。
    ctx.globalCompositeOperation='lighter';
    var i=fireworks.length;
    while(i--){
      fireworks[i].draw();
      fireworks[i].update(i);
    }
    var i=particles.length;
    while(i--){
      particles[i].draw();
      particles[i].update(i);
    }
    //此时，我们还没有创建任何的烟花。我们希望设置一个定时时间timerTotal，周期性的
    // 产生一个烟花，我们也需要一个时间计数timerTick，在每次帧更新的时候加1，记下帧更新的次数。
    if(timerTick>=timerTotal)
    {
      fireworks.push(new Firework(clientw/2,clienth,random(0,clientw),random(0,clienth)));
      timerTick=0;
    }
    else{
      timerTick++;
    }
  }
  </script>

    </div>
  </footer>

  
  <script src="https://unpkg.com/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/135xyq.github.io/js/comments.js"></script><script src="/135xyq.github.io/js/utils.js"></script><script src="/135xyq.github.io/js/motion.js"></script><script src="/135xyq.github.io/js/next-boot.js"></script><script src="/135xyq.github.io/js/bookmark.js"></script>

  
<script src="https://unpkg.com/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/135xyq.github.io/js/third-party/search/local-search.js"></script>
<script class="next-config" data-name="chatra" type="application/json">{"enable":true,"async":true,"id":"ruWaHnsjKGdZQCSiC"}</script>
<script src="/135xyq.github.io/js/third-party/chat/chatra.js"></script>
<script async src="https://call.chatra.io/chatra.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://unpkg.com/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/135xyq.github.io/js/third-party/math/mathjax.js"></script>


<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script><script src="https://unpkg.com/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '64px',
  right: '32px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>
<script class="next-config" data-name="changyan" type="application/json">{"enable":true,"appid":"cyvS6KuDV","appkey":"48e71f62cb3f29222e2ee2c1f7abcc74"}</script>
<script src="/135xyq.github.io/js/third-party/comments/changyan.js"></script>

</body>
</html>
